Date: 2026-02-16

Goal:
  v4 E2E (real device WebView) proving PRD-V4 major gaps are closed:
  Page API + CONTENT refs + attrs query alignment + expanded stats fields.

Commands (PowerShell):
  .\gradlew :agent-browser-kotlin:test --no-daemon
  .\gradlew :app:connectedAndroidTest --no-daemon
  pwsh -File .\scripts\pull-e2e-video.ps1

Coverage highlights (instrumentation, offline assets):
  - Page: page(info) + page(scroll) and asserts scrollY increases
  - Snapshot: interactiveOnly=false assigns refs to content nodes (asserts h1 has ref)
  - Query: attrs returns full attributes (asserts id=btnToggle appears)
  - Stats: snapshot stats includes domNodes/skippedHidden (schema-level support; values are populated in JS)

Artifacts:
  - Device frames:
      /sdcard/Download/agent-browser-kotlin/e2e/frames/run-<millis>-step-*.png
  - Local video (built from latest run frames):
      adb_dumps\e2e\latest\e2e-latest.mp4

Perf/size evidence (from Gradle connected test logcat):
  - Source:
      app/build/outputs/androidTest-results/connected/debug/RTE-AL00 - 12/logcat-com.lsl.agent_browser_kotlin.WebViewE2eTest-snapshot_fill_click_resnapshot_sees_dom_change.txt
  - Observed:
      [STEP 16] stress snapshot jsonBytes=838 jsTimeMs=39
